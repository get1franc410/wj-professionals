<!--C:\Users\Adeyanju Joshua\Desktop\lexy sofware\wj_professional web_updated_temp\wj_professionals\templates\core\tax_calculator.html-->
{% extends 'base.html' %}
{% load static %}

{% block title %}Tax Calculators - {{ company.name }}{% endblock %}

{% block content %}
<!-- Page Title -->
<div class="page-title dark-background">
  <div class="container position-relative">
    <h1>Tax Calculators</h1>
    <p>Professional tax calculation tools to help you plan and estimate your tax obligations</p>
    <nav class="breadcrumbs">
      <ol>
        <li><a href="{% url 'core:home' %}">Home</a></li>
        <li class="current">Tax Calculators</li>
      </ol>
    </nav>
  </div>
</div>

<!-- Tax Calculators Section -->
<section id="tax-calculators" class="tax-calculators section">
  <div class="container">
    
    <!-- Section Header -->
    <div class="section-title" data-aos="fade-up">
      <h2>Tax Calculation Tools</h2>
      <p>Use our professional calculators to estimate your tax liabilities based on current Nigerian tax rates</p>
    </div>

    <div class="row gy-4">
      
      <!-- Personal Income Tax Calculator -->
      <div class="col-lg-6" data-aos="fade-up" data-aos-delay="100">
        <div class="service-item item-cyan position-relative">
          <div class="icon">
            <i class="bi bi-person-circle"></i>
          </div>
          <div>
            <h4><a href="#" class="stretched-link">Personal Income Tax</a></h4>
            <p>Calculate your personal income tax based on current Nigerian tax rates and allowable reliefs.</p>
            
            <form id="personalTaxForm" class="mt-4">
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="annualIncome" class="form-label">Annual Income (₦)</label>
                  <input type="number" class="form-control" id="annualIncome" placeholder="Enter annual income">
                </div>
                <div class="col-md-6 mb-3">
                  <label for="reliefs" class="form-label">Total Reliefs (₦)</label>
                  <input type="number" class="form-control" id="reliefs" placeholder="Enter reliefs" value="200000">
                </div>
              </div>
              <button type="button" class="btn btn-primary" onclick="calculatePersonalTax()">
                <i class="bi bi-calculator me-2"></i>Calculate Tax
              </button>
            </form>
            
            <div id="personalTaxResult" class="mt-4" style="display: none;">
              <div class="alert alert-info">
                <h6><i class="bi bi-info-circle me-2"></i>Calculation Result:</h6>
                <p class="mb-1"><strong>Taxable Income:</strong> ₦<span id="taxableIncome"></span></p>
                <p class="mb-1"><strong>Income Tax:</strong> ₦<span id="incomeTax"></span></p>
                <p class="mb-0"><strong>Net Income:</strong> ₦<span id="netIncome"></span></p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Company Income Tax Calculator -->
      <div class="col-lg-6" data-aos="fade-up" data-aos-delay="200">
        <div class="service-item item-orange position-relative">
          <div class="icon">
            <i class="bi bi-building"></i>
          </div>
          <div>
            <h4><a href="#" class="stretched-link">Company Income Tax</a></h4>
            <p>Calculate corporate income tax for your business based on company size and profit.</p>
            
            <form id="companyTaxForm" class="mt-4">
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="companyType" class="form-label">Company Type</label>
                  <select class="form-select" id="companyType">
                    <option value="large">Large Company (30%)</option>
                    <option value="medium">Medium Company (20%)</option>
                    <option value="small">Small Company (0%)</option>
                  </select>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="totalProfit" class="form-label">Total Profit (₦)</label>
                  <input type="number" class="form-control" id="totalProfit" placeholder="Enter profit">
                </div>
              </div>
              <div class="mb-3">
                <label for="allowableDeductions" class="form-label">Allowable Deductions (₦)</label>
                <input type="number" class="form-control" id="allowableDeductions" placeholder="Enter deductions">
              </div>
              <button type="button" class="btn btn-primary" onclick="calculateCompanyTax()">
                <i class="bi bi-calculator me-2"></i>Calculate Tax
              </button>
            </form>
            
            <div id="companyTaxResult" class="mt-4" style="display: none;">
              <div class="alert alert-success">
                <h6><i class="bi bi-check-circle me-2"></i>Calculation Result:</h6>
                <p class="mb-1"><strong>Assessable Profit:</strong> ₦<span id="assessableProfit"></span></p>
                <p class="mb-1"><strong>Tax Rate:</strong> <span id="taxRate"></span>%</p>
                <p class="mb-1"><strong>Company Income Tax:</strong> ₦<span id="companyTax"></span></p>
                <p class="mb-0"><strong>Profit After Tax:</strong> ₦<span id="profitAfterTax"></span></p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- VAT Calculator -->
      <div class="col-lg-6" data-aos="fade-up" data-aos-delay="300">
        <div class="service-item item-teal position-relative">
          <div class="icon">
            <i class="bi bi-percent"></i>
          </div>
          <div>
            <h4><a href="#" class="stretched-link">VAT Calculator</a></h4>
            <p>Calculate Value Added Tax (VAT) at the current 7.5% rate for your transactions.</p>
            
            <form id="vatForm" class="mt-4">
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="vatType" class="form-label">Calculation Type</label>
                  <select class="form-select" id="vatType">
                    <option value="exclusive">Add VAT to Amount</option>
                    <option value="inclusive">Extract VAT from Amount</option>
                  </select>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="vatAmount" class="form-label">Amount (₦)</label>
                  <input type="number" class="form-control" id="vatAmount" placeholder="Enter amount">
                </div>
              </div>
              <button type="button" class="btn btn-primary" onclick="calculateVAT()">
                <i class="bi bi-calculator me-2"></i>Calculate VAT
              </button>
            </form>
            
            <div id="vatResult" class="mt-4" style="display: none;">
              <div class="alert alert-warning">
                <h6><i class="bi bi-exclamation-triangle me-2"></i>VAT Calculation:</h6>
                <p class="mb-1"><strong>Original Amount:</strong> ₦<span id="originalAmount"></span></p>
                <p class="mb-1"><strong>VAT (7.5%):</strong> ₦<span id="vatValue"></span></p>
                <p class="mb-0"><strong>Total Amount:</strong> ₦<span id="totalWithVat"></span></p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Withholding Tax Calculator -->
      <div class="col-lg-6" data-aos="fade-up" data-aos-delay="400">
        <div class="service-item item-red position-relative">
          <div class="icon">
            <i class="bi bi-cash-stack"></i>
          </div>
          <div>
            <h4><a href="#" class="stretched-link">Withholding Tax</a></h4>
            <p>Calculate withholding tax based on different transaction types and applicable rates.</p>
            
            <form id="whtForm" class="mt-4">
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="whtType" class="form-label">Transaction Type</label>
                  <select class="form-select" id="whtType">
                    <option value="5">Professional Services (5%)</option>
                    <option value="10">Rent (10%)</option>
                    <option value="5">Technical Services (5%)</option>
                    <option value="2.5">Interest (2.5%)</option>
                    <option value="10">Dividend (10%)</option>
                    <option value="5">Royalty (5%)</option>
                  </select>
                </div>
                <div class="col-md-6 mb-3">
                  <label for="whtAmount" class="form-label">Transaction Amount (₦)</label>
                  <input type="number" class="form-control" id="whtAmount" placeholder="Enter amount">
                </div>
              </div>
              <button type="button" class="btn btn-primary" onclick="calculateWHT()">
                <i class="bi bi-calculator me-2"></i>Calculate WHT
              </button>
            </form>
            
            <div id="whtResult" class="mt-4" style="display: none;">
              <div class="alert alert-info">
                <h6><i class="bi bi-info-circle me-2"></i>WHT Calculation:</h6>
                <p class="mb-1"><strong>Transaction Amount:</strong> ₦<span id="transactionAmount"></span></p>
                <p class="mb-1"><strong>WHT Rate:</strong> <span id="whtRate"></span>%</p>
                <p class="mb-1"><strong>Withholding Tax:</strong> ₦<span id="whtValue"></span></p>
                <p class="mb-0"><strong>Net Amount Payable:</strong> ₦<span id="netPayable"></span></p>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>

    <!-- Disclaimer -->
    <div class="row mt-5">
      <div class="col-12" data-aos="fade-up">
        <div class="alert alert-warning">
          <h6><i class="bi bi-exclamation-triangle me-2"></i>Important Disclaimer</h6>
          <p class="mb-0">These calculators provide estimates based on current Nigerian tax rates and should be used for guidance only. For accurate tax computation and compliance, please consult with our professional team. Tax rates and regulations may change, and individual circumstances may affect actual tax liability.</p>
        </div>
      </div>
    </div>

    <!-- Contact CTA -->
    <div class="row mt-4">
      <div class="col-12 text-center" data-aos="fade-up">
        <h4>Need Professional Tax Assistance?</h4>
        <p class="text-muted">Our certified tax professionals are here to help you with accurate tax planning and compliance.</p>
        <a href="{% url 'contact:contact' %}?subject=Tax Consultation" class="btn-get-started">
          Contact Our Tax Experts
        </a>
      </div>
    </div>

  </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
// Keep all your existing JavaScript functions here
// Personal Income Tax Calculator
function calculatePersonalTax() {
    const income = parseFloat(document.getElementById('annualIncome').value) || 0;
    const reliefs = parseFloat(document.getElementById('reliefs').value) || 0;
    
    if (income <= 0) {
        alert('Please enter a valid annual income');
        return;
    }
    
    const minRelief = Math.max(income * 0.2, 200000);
    const actualRelief = Math.max(reliefs, minRelief);
    const taxableIncome = Math.max(income - actualRelief, 0);
    
    let tax = 0;
    if (taxableIncome > 0) {
        if (taxableIncome <= 300000) {
            tax = taxableIncome * 0.07;
        } else if (taxableIncome <= 600000) {
            tax = 21000 + (taxableIncome - 300000) * 0.11;
        } else if (taxableIncome <= 1100000) {
            tax = 54000 + (taxableIncome - 600000) * 0.15;
        } else if (taxableIncome <= 1600000) {
            tax = 129000 + (taxableIncome - 1100000) * 0.19;
        } else if (taxableIncome <= 3200000) {
            tax = 224000 + (taxableIncome - 1600000) * 0.21;
        } else {
            tax = 560000 + (taxableIncome - 3200000) * 0.24;
        }
    }
    
    const netIncome = income - tax;
    
    document.getElementById('taxableIncome').textContent = taxableIncome.toLocaleString();
    document.getElementById('incomeTax').textContent = tax.toLocaleString();
    document.getElementById('netIncome').textContent = netIncome.toLocaleString();
    document.getElementById('personalTaxResult').style.display = 'block';
}

// Company Income Tax Calculator
function calculateCompanyTax() {
    const companyType = document.getElementById('companyType').value;
    const profit = parseFloat(document.getElementById('totalProfit').value) || 0;
    const deductions = parseFloat(document.getElementById('allowableDeductions').value) || 0;
    
    if (profit <= 0) {
        alert('Please enter a valid profit amount');
        return;
    }
    
    const assessableProfit = Math.max(profit - deductions, 0);
    
    let taxRate = 0;
    switch(companyType) {
        case 'large': taxRate = 30; break;
        case 'medium': taxRate = 20; break;
        case 'small': taxRate = 0; break;
    }
    
    const tax = assessableProfit * (taxRate / 100);
    const profitAfterTax = assessableProfit - tax;
    
    document.getElementById('assessableProfit').textContent = assessableProfit.toLocaleString();
    document.getElementById('taxRate').textContent = taxRate;
    document.getElementById('companyTax').textContent = tax.toLocaleString();
    document.getElementById('profitAfterTax').textContent = profitAfterTax.toLocaleString();
    document.getElementById('companyTaxResult').style.display = 'block';
}

// VAT Calculator
function calculateVAT() {
    const vatType = document.getElementById('vatType').value;
    const amount = parseFloat(document.getElementById('vatAmount').value) || 0;
    
    if (amount <= 0) {
        alert('Please enter a valid amount');
        return;
    }
    
    let originalAmount, vatValue, totalAmount;
    
    if (vatType === 'exclusive') {
        originalAmount = amount;
        vatValue = amount * 0.075;
        totalAmount = amount + vatValue;
    } else {
        totalAmount = amount;
        originalAmount = amount / 1.075;
        vatValue = amount - originalAmount;
    }
    
    document.getElementById('originalAmount').textContent = originalAmount.toLocaleString();
    document.getElementById('vatValue').textContent = vatValue.toLocaleString();
    document.getElementById('totalWithVat').textContent = totalAmount.toLocaleString();
    document.getElementById('vatResult').style.display = 'block';
}

// Withholding Tax Calculator
function calculateWHT() {
    const whtRate = parseFloat(document.getElementById('whtType').value);
    const amount = parseFloat(document.getElementById('whtAmount').value) || 0;
    
    if (amount <= 0) {
        alert('Please enter a valid transaction amount');
        return;
    }
    
    const whtValue = amount * (whtRate / 100);
    const netPayable = amount - whtValue;
    
    document.getElementById('transactionAmount').textContent = amount.toLocaleString();
    document.getElementById('whtRate').textContent = whtRate;
    document.getElementById('whtValue').textContent = whtValue.toLocaleString();
    document.getElementById('netPayable').textContent = netPayable.toLocaleString();
    document.getElementById('whtResult').style.display = 'block';
}

// Format numbers as currency
Number.prototype.toLocaleString = function() {
    return this.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
};
</script>
{% endblock %}
